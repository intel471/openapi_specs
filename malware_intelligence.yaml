openapi: 3.0.0
info:
  title: Titan API v1
  description: Malware indicators lookup API.
  version: 1.19.7
servers:
  - url: https://api.intel471.com/v1
    description: "Production server."
paths:
  /indicators:
    get:
      summary: Search Malware Intelligence Indicators
      description: "Returns list of Indicators matching filter criteria. Supported types are IPv4 address, URL and file hashes"
      parameters:
        - name: indicator
          in: query
          schema:
            type: string
          description: Free text indicator search (all fields included).
        - name: indicatorType
          in: query
          schema:
            type: string
          description: "Search indicators by type (e.g. `file`, `ipv4`, `url`)."
      responses:
        '200':
          description: A JSON array of malware indicators
          content:
            application/json:
              schema:
                type: object
                required:
                  - indicatorTotalCount
                properties:
                  indicatorTotalCount:
                    type: integer
                    description: Total count of matched indicators.
                  indicatorPartialResult:
                    type: boolean
                    description: Indicates whether response contains partial result. It could be in case when request took too long and was terminated by timeout.
                  indicators:
                    type: array
                    description: "List of `Indicators`"
                    items:
                      type: object
                      required:
                        - last_updated
                        - data
                      properties:
                        last_updated:
                          type: integer
                          format: int64
                          description: Indicator last modification date. Represented as milliseconds since the epoch.
                        data:
                          type: object
                          description: Sub-document containing indicator information. Might contain fields specific for different indicator types.
                          required:
                            - uid
                            - threat
                            - indicator_type
                            - indicator_data
                            - expiration
                            - confidence
                          properties:
                            uid:
                              type: string
                              description: Indicator's UID
                            threat:
                              type: object
                              description: Detailed information about a threat.
                              required:
                                - uid
                                - type
                                - data
                              properties:
                                uid:
                                  type: string
                                  description: Unique threat identifier.
                                type:
                                  type: string
                                  description: "Threat type: `malware`, `proxy_service` etc."
                                data:
                                  type: object
                                  description: "Additional details about a threat such as service `provider`, `malware family`, `malware family version`, etc."
                                  properties:
                                    family:
                                      type: string
                                      description: "Malware family: `gozi_isfb`, `smokeloader`, `trickbot` etc (for `malware` threat type)."
                                    malware_family_profile_uid:
                                      type: string
                                      description: Malware family profile UID.
                                    version:
                                      type: string
                                      description: Version of the threat.
                                    variant:
                                      type: string
                                      description: Variant of the threat.
                            indicator_type:
                              type: string
                              description: "Describes the type of indicator: (e.g. file, ipv4, url)."
                            indicator_data:
                              type: object
                              description: Sub-document containing indicator type and value(s).
                              properties:
                                url:
                                  type: string
                                  description: The `url` of the malware indicator.
                                address:
                                  type: string
                                  description: IPv4 address of the malware indicator.
                                file:
                                  type: object
                                  description: Malicious file details
                                  properties:
                                    md5:
                                      type: string
                                      description: File's MD5 sum
                                    sha1:
                                      type: string
                                      description: File's SHA1 sum
                                    sha256:
                                      type: string
                                      description: File's SHA256 sum
                                    type:
                                      type: string
                                      description: File's type
                                    size:
                                      type: integer
                                      description: File's size
                                    ssdeep:
                                      type: string
                                      description: File's ssdeep hash (fuzzy hash)
                                    download_url:
                                      type: string
                                      description: File's download URL
                                geo_ip:
                                  type: object
                                  description: Geo IP
                                  properties:
                                    country:
                                      type: string
                                      description: Country
                                    country_code:
                                      type: string
                                      description: Country code
                                    city:
                                      type: string
                                      description: City
                                    subdivision:
                                      type: array
                                      description: Subdivision
                                      items:
                                        type: string
                                    isp:
                                      type: object
                                      description: ISP details
                                      properties:
                                        network:
                                          type: string
                                          description: Network
                                        autonomous_system:
                                          type: string
                                          description: Autonomous System
                                        isp:
                                          type: string
                                          description: ISP name
                                        organization:
                                          type: string
                                          description: Organization
                            expiration:
                              type: integer
                              description: Time of indicator's expiration represented as milliseconds since the epoch. Indicator should be removed from block lists at this time.
                            confidence:
                              type: string
                              description: "Indicators with `high` confidence are derived from a primary source and are verified. They can safely be used for blocking.
                              If indicators are from a primary source, but they have not been verified, then the confidence rating is reduced to `medium`. We recommend them for alerting or threat hunting.
                              An example of this is a controller URL extracted from a malware configuration file. The file is verified (high), but the controller URLs inside it’s configuration are not (medium).
                              Indicators that are derived from a third party source via pivoting are marked as `low` confidence unless they have been verified. We don’t publish many low confidence indicators."
                            context:
                              type: object
                              description: Sub-document containing contextual information to describe the observed malicious activity.
                              required:
                                - description
                              properties:
                                description:
                                  type: string
                                  description: Free form text describing the indicator context.
                            mitre_tactics:
                              type: string
                              description: The MITRE ATT&CK tactic classification.
                            intel_requirements:
                              type: array
                              description: List of Intel 471's General Intelligence Requirements matching this indicator.
                              items:
                                type: string
                        meta:
                          type: object
                          description: Meta data used to describe document version.
                          required:
                            - version
                          properties:
                            version:
                              type: string
                              description: Document `version`.
                        uid:
                          type: string
                          description: Unique indicator identifier.
                        activity:
                          type: object
                          description: Period an indicator was active.
                          required:
                            - first
                            - last
                          properties:
                            first:
                              type: integer
                              description: Start time of the indicator activity range. Represented as milliseconds since the epoch.
                            last:
                              type: integer
                              description: End time of the indicator activity range. Represented as milliseconds since the epoch.
        '401':
          description: Unauthorized
        '412':
          description: Precondition Failed
  /malwareFamilies:
    get:
      summary: Search Malware Families
      description: "Returns list of `MalwareFamilies` matching filter criteria."
      parameters:
        - name: malwareFamily
          in: query
          schema:
            type: string
          example: asyncrat
          description: Free text malware family search by malware family name.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                required:
                  - malware_family_total_count
                properties:
                  malware_family_total_count:
                    type: integer
                    description: Total count of matched results.
                    example: 95
                  malware_families:
                    type: array
                    description: List of Malware reports.
                    items:
                      type: object
                      required:
                        - uid
                        - malware_family
                        - activity
                      properties:
                        uid:
                          type: string
                          description: Unique Malware Family identifier.
                          example: 73588f457b80c3c793fbd56beb0b698b
                        malware_family:
                          type: string
                          description: Unique Malware Family name.
                          example: amadey
                        activity:
                          type: object
                          description: Period Malware report was active.
                          required:
                            - first
                            - last
                          properties:
                            first:
                              type: integer
                              description: Start of the Malware Family activity range.
                              example: 1662656016000
                            last:
                              type: integer
                              description: End of the Malware Family activity range.
                              example: 1664366859000
        '401':
          description: Unauthorized
        '412':
          description: Precondition Failed
  /malwareReports:
    get:
      summary: Search Malware Intelligence Reports
      description: Returns list of `Malware reports` matching filter criteria.
      parameters:
        - name: malwareReport
          in: query
          description: Free text Malware reports search (all fields included). At least one of `malwareReport`, `threatType`, `reportTitle`, `malwareFamily`, 'malwareFamilyProfileUid` is required.
          schema:
            type: string
        - name: threatType
          in: query
          description: Search Malware reports by threat type
          schema:
            type: string
          example: malware
        - name: reportTitle
          in: query
          description: Search Malware reports by threat UID
          schema:
            type: string
        - name: malwareFamily
          in: query
          description: Search Malware reports by malware family (e.g. `gozi_isfb`, `smokeloader`, `trickbot`).
          schema:
            type: string
        - name: malwareFamilyProfileUid
          in: query
          description: Search Malware reports by malware family profile UID. Useful for getting context for everything we have around specific malware family, for instance https://api.intel471.com/v1/search?malwareFamilyProfileUid=20eb1f82621001883ea0c2085aff5729.
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                required:
                  - malwareReportTotalCount
                properties:
                  malwareReportTotalCount:
                    type: integer
                    description: Total count of matched results.
                  malwareReportsPartialResult:
                    type: boolean
                    description: Indicates whether response contains partial result. It could be in case when request took too long and was terminated by timeout.
                  malwareReports:
                    type: array
                    description: List of Malware reports.
                    items:
                      type: object
                      required:
                        - uid
                        - data
                        - meta
                        - last_updated
                        - activity
                      properties:
                        uid:
                          type: string
                          description: Unique Malware report identifier.
                        data:
                          type: object
                          description: "Sub-document containing Malware reports information.
                          Might contain fields specific for different Malware reports types which are not described in current documentation."
                          required:
                            - threat
                            - malware_report_data
                          properties:
                            threat:
                              type: object
                              description: Detailed information about a threat.
                              required:
                                - uid
                                - type
                                - data
                              properties:
                                uid:
                                  type: string
                                  description: Unique threat identifier.
                                type:
                                  type: string
                                  description: "Threat type: `malware`, `proxy_service` etc."
                                data:
                                  type: object
                                  description: "Additional details about a threat such as service `provider`, `malware family`, `malware family version`, etc."
                                  properties:
                                    family:
                                      type: string
                                      description: "Malware family: `gozi_isfb`, `smokeloader`, `trickbot` etc (for `malware` threat type)."
                                    malware_family_profile_uid:
                                      type: string
                                      description: Malware family profile UID.
                                    version:
                                      type: string
                                      description: "`Version` of threat."
                            malware_report_data:
                              type: object
                              required:
                                - title
                                - text
                                - released_at
                              description: Sub-document containing Malware report data.
                              properties:
                                title:
                                  type: string
                                  description: Malware report `title`.
                                text:
                                  type: string
                                  description: Malware report `text`.
                                released_at:
                                  type: integer
                                  description: Malware report released date.
                                related_reports:
                                  type: array
                                  description: Malware report `uid` of related reports like "Information Report" or "Malware Report".
                                  items:
                                    type: string
                                sensitive_source:
                                  type: boolean
                                  description: Indicates if the document contains sensitive source derived information.
                                attachments:
                                  type: array
                                  description: Malware report `attachments` list.
                                  items:
                                    type: object
                                    required:
                                      - name
                                      - url
                                      - size
                                      - mime_type
                                    properties:
                                      name:
                                        type: string
                                        description: Attachment file `name`.
                                      url:
                                        type: string
                                        description: "`Url` to download attachment."
                                      size:
                                        type: integer
                                        description: Attachment fie `size` in bytes.
                                      mime_type:
                                        type: string
                                        description: Mimetype
                                      malicious:
                                        type: boolean
                                        description: "Indicates if attachment is malicious. If `malicious=true`, attachment will be an archive with password `infected`"
                        meta:
                          type: object
                          required:
                            - version
                          description: Meta data used to describe document version.
                          properties:
                            version:
                              type: string
                              description: Document `version`.
                        last_updated:
                          type: integer
                          description: Malware report last modification date.
                        activity:
                          type: object
                          description: Period Malware report was active.
                          required:
                            - first
                            - last
                          properties:
                            first:
                              type: integer
                              description: Start of the Malware report activity range.
                            last:
                              type: integer
                              description: End of the Malware report activity range.
                        classification:
                          type: object
                          description: "`Classification {Object}`."
                          properties:
                            intelRequirements:
                              type: array
                              description: General Intel Requirements (GIR).
                              items:
                                type: string
        '401':
          description: Unauthorized
        '412':
          description: Precondition Failed
